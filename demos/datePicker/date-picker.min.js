!function(t,e,i){"use strict";t.DatePicker||(m.prototype={init:function(t){this.createPicker(),this.format=this.initFormat(t),this.initInputs(),this.api={set:this.set.bind(this),join:"/",show:this.showPicker.bind(this),value:"",refresh:this.refresh.bind(this),callback:function(t){console.log(JSON.stringify(t))}}},set:function(t,e){this.isInput(t)&&(e instanceof Object||(this.datas[t.bindId]?e={offset:l(t)}:(h(t,"focus",this.showPicker.bind(this,t)),e={offset:l(t),max:null,min:null,format:this.format,range:null,bind:null}),this.setInput(t,e)))},createPicker:function(){var t=n("style");t.type="text/css",t.innerHTML="",e.getElementsByTagName("head")[0].appendChild(t);var i=this.doms.box=n("div");i.className="-date-picker";i.innerHTML="            <div id='-date-picker-point'>                <div class='-rotate45'></div>            </div>            <div class='-date-picker-main'>                <div id='-date-picker-main'></div>            </div>",e.body.appendChild(i),this.reSize(),this.getElement()},createSelectBox:function(){var t=n("div");t.className="-date-picker-select",t.innerHTML="            <div class='-d-p-select-head'>                <div id='-d-p-select-head'></div>            </div>            <div class='-d-p-select-year-month'>                <div id='-d-p-select-main'></div>            </div>            <div class='-d-p-select-foot'>                <div>                    <button id='-date-picker-btn-back'>返回</button>                </div>            </div>",this.doms.main.appendChild(t),this.getElement(2)},createDayBox:function(){var t=n("div"),e=n("div"),i=n("div");o(t,"-date-picker-head"),o(e,"-date-picker-day"),o(i,"-date-picker-btn"),t.innerHTML="            <div>                <div class='-date-picker-ym'>                    <button id='-date-picker-ym'></button>                    <span class='-dpcymt -rotate45'></span>                </div>            </div>",i.innerHTML="            <div>                <div id='-date-picker-btn-tday'><button>今&emsp;天</button></div>                <div id='-date-picker-btn-ystday'><button>昨&emsp;天</button></div>                <div id='-date-picker-btn-lsweek'><button>上一周</button></div>                <div id='-date-picker-btn-lsmonth'><button>上一月</button></div>                <div id='-date-picker-btn-hour'><button>00</button></div>                <div id='-date-picker-btn-minute'><button>00</button></div>                <div id='-date-picker-btn-second'><button>00</button></div>                <div id='-date-picker-btn-confirm'><button>确定</button></div>            </div>";for(var s="            <div>                <div class='-date-picker-title'>",a=0;a<this.week.length;a++)s+="<button class=''>",s+=this.week[a],s+="</button>";s+="                </div>                <div id='-date-picker-prev'>                    <div class='-rotate45'></div>                </div>                <div class='-date-picker-box'>                    <div id='-date-picker-year' data-month='0' style='transition:transform 300ms;'>                        <div class='-prev-year'>上一年</div>";for(a=1;a<13;a++)s+="<div class='-date-picker-month'><div class='-bg-month'>",s+=a,s+="</div></div>";s+="                        <div class='-next-year'>下一年</div>                    </div>                </div>                <div id='-date-picker-next'>                    <div class='-rotate45'></div>                </div>            </div>",e.innerHTML=s,this.doms.main.appendChild(t),this.doms.main.appendChild(e),this.doms.main.appendChild(i),this.getElement(1)},createMonthBox:function(){this.state.step[2]||this.createSelectBox();var t=n("div"),e=n("div"),i="";t.id="-d-p-select-year-touch",o(e,"-d-p-s-month-box"),t.innerHTML="            <div class='-d-p-select-left'></div>            <div class='-d-p-select-box'>                <div id='-d-p-select-year'></div>            </div>            <div class='-d-p-select-right'></div>";for(var s=0;s<12;s++)i+="<div class='-d-p-s-month' data-month='",i+=s+1,i+="'><div>",i+=this.month[s],i+="月<div class='-d-p-s-m-en'>",i+=this.monthEn[s],i+="</div></div></div>";e.innerHTML=i,this.doms.selectHead.appendChild(t),this.doms.selectMain.appendChild(e),this.getElement(3)},createYearBox:function(){this.state.step[2]||this.createSelectBox();var t=n("button"),e=n("div");o(e,"-d-p-s-year-box"),e.innerHTML="            <div id='-d-p-s-year-prev'>                <div class='-rotate45'></div>            </div>            <div class='-d-p-s-y-box'>                <div id='-d-p-s-y-box'></div>            </div>            <div id='-d-p-s-year-next'>                <div class='-rotate45'></div>            </div>",t.id="-d-p-select-year-range",this.doms.selectHead.appendChild(t),this.doms.selectMain.appendChild(e),this.getElement(4)},getElement:function(t){t=t||0;var i=this.doms,s=i.box,a=e.getElementById.bind(e);switch(t){case 0:i.point=a("-date-picker-point"),i.main=a("-date-picker-main");break;case 1:i.btn=a("-date-picker-ym"),i.btnBox=i.btn.parentElement,i.year=a("-date-picker-year"),i.dayBox=i.year.parentElement,i.months=d(s,"-date-picker-month"),i.prevMonth=a("-date-picker-prev"),i.nextMonth=a("-date-picker-next"),i.today=a("-date-picker-btn-tday"),i.yesterday=a("-date-picker-btn-ystday"),i.lastweek=a("-date-picker-btn-lsweek"),i.lastmonth=a("-date-picker-btn-lsmonth"),i.hour=a("-date-picker-btn-hour"),i.hourBtn=i.hour.children[0],i.minute=a("-date-picker-btn-minute"),i.minuteBtn=i.minute.children[0],i.second=a("-date-picker-btn-second"),i.secondBtn=i.second.children[0],i.confirm=a("-date-picker-btn-confirm");break;case 2:i.selectHead=a("-d-p-select-head"),i.selectMain=a("-d-p-select-main"),i.backBtn=a("-date-picker-btn-back");break;case 3:i.touchBox=a("-d-p-select-year"),i.yearDrag=a("-d-p-select-year-touch"),i.monthBtns=d(s,"-d-p-s-month"),i.monthBox=i.monthBtns[0].parentElement;break;case 4:i.yearRnage=a("-d-p-select-year-range"),i.prevYear=a("-d-p-s-year-prev"),i.nextYear=a("-d-p-s-year-next"),i.yearBox=a("-d-p-s-y-box")}this.state.step||(this.state.step={}),this.state.step[t]||this.initEvent(t),this.state.step[t]=!0},initEvent:function(e){var i=h,s=this.doms;switch(e){case 0:i(t,"resize",this.reSize.bind(this)),i(s.box,"touchmove",this.disabledEvent);break;case 1:var a=s.dayBox;i(s.btnBox,"click",this.clickEv.bind(this,s.btnBox)),i(s.prevMonth,"click",this.prevMonth.bind(this)),i(s.nextMonth,"click",this.nextMonth.bind(this)),i(s.today,"click",this.clickEv.bind(this,s.today)),i(s.yesterday,"click",this.clickEv.bind(this,s.yesterday)),i(s.lastweek,"click",this.clickEv.bind(this,s.lastweek)),i(s.lastmonth,"click",this.clickEv.bind(this,s.lastmonth)),i(s.hour,"click",this.clickEv.bind(this,s.hour)),i(s.minute,"click",this.clickEv.bind(this,s.minute)),i(s.second,"click",this.clickEv.bind(this,s.second)),i(s.confirm,"click",this.clickEv.bind(this,s.confirm)),i(a,"click",this.clickEv.bind(this,a)),i(a,"touchstart",this.touchS.bind(this,a)),i(a,"touchmove",this.touchM.bind(this,a)),i(a,"touchend",this.touchE.bind(this,a)),i(a,"touchcancel",this.touchE.bind(this,a)),this.isFF?i(a,"DOMMouseScroll",this.mouseW.bind(this,a)):i(a,"mousewheel",this.mouseW.bind(this,a));break;case 2:i(s.backBtn,"click",this.back.bind(this));break;case 3:var n=s.yearDrag;i(s.monthBox,"click",this.clickEv.bind(this,s.monthBox)),i(n,"click",this.clickEv.bind(this,n)),i(n,"touchstart",this.touchS.bind(this,n)),i(n,"touchmove",this.touchM.bind(this,n)),i(n,"touchend",this.touchE.bind(this,n)),i(n,"touchcancel",this.touchE.bind(this,n)),this.isFF?i(n,"DOMMouseScroll",this.mouseW.bind(this,n)):i(n,"mousewheel",this.mouseW.bind(this,n));break;case 4:var r=s.yearBox;i(s.yearBox,"click",this.clickEv.bind(this,s.yearBox)),i(s.prevYear,"click",this.clickEv.bind(this,s.prevYear)),i(s.nextYear,"click",this.clickEv.bind(this,s.nextYear)),i(r,"touchstart",this.touchS.bind(this,r)),i(r,"touchmove",this.touchM.bind(this,r)),i(r,"touchend",this.touchE.bind(this,r)),i(r,"touchcancel",this.touchE.bind(this,r)),this.isFF?i(r,"DOMMouseScroll",this.mouseW.bind(this,r)):i(r,"mousewheel",this.mouseW.bind(this,r))}},reSize:function(){var t=this.doms.box;t.style.visibility="hidden",r(t,"block"),this.state.boxWidth=t.offsetWidth,this.state.boxHeight=t.offsetHeight,r(t,"none"),t.style.visibility="visible"},refresh:function(){for(var t in this.datas)this.set(this.datas[t].el)},disabledEvent:function(e){return(e=e||t.event).preventDefault&&e.preventDefault(),e.stopPropagation&&event.stopPropagation(),!1},blurPicker:function(e){var i=!0;if((e=e||t.event).target!=t){var s=c(e.target,".-date-picker"),a=c(e.target,"input");if(s)i=!1;else if(a)for(var n in this.datas)if(this.datas[n].el===a){i=!1;break}}i&&(this.hidePicker(),this.endSelect())},hidePicker:function(){r(this.doms.box,"none"),this.state.cY=0,this.state.date=void 0,this.state.focus=void 0,this.maxDate=void 0,this.minDate=void 0},initInputs:function(){for(var t={},i=d(e,"datepicker"),s=0;s<i.length;s++){var a=i[s];if(this.isInput(a)){h(a,"focus",this.showPicker.bind(this,a));(o={min:a.getAttribute("min"),max:a.getAttribute("max"),bind:a.getAttribute("bind"),range:a.getAttribute("range"),format:this.initFormat(a.getAttribute("format")),offset:l(a)}).min&&"now"!=o.min&&"string"==typeof o.min&&!o.min.match(/[YMD]\d+(?!\d)/g)&&(o.min=this.judgeDateStr(o.min,o.format)),o.max&&"now"!=o.max&&"string"==typeof o.max&&!o.max.match(/[YMD]\d+(?!\d)/g)&&(o.max=this.judgeDateStr(o.max,o.format)),o.range&&o.bind&&"start"==o.range||"end"==o.range?(t[o.bind]||(t[o.bind]={}),t[o.bind][o.range]||(t[o.bind][o.range]={el:a,op:o})):this.setInput(a,o)}}for(var n in t){var r=t[n];if(r.start&&r.end){var o;(o={min:r.end.op.min||r.start.op.min,max:r.end.op.max||r.start.op.max,format:r.end.op.format||r.start.op.format}).bindElId=r.end.el.bindId,o.range="start",o.offset=r.start.offset,this.setInput(r.start.el,o),o.bindElId=r.start.el.bindId,o.range="end",o.offset=r.end.offset,this.setInput(r.end.el,o)}else{var c=r.start||r.end;c.op.range="self",this.setInput(c.el,c.op)}}},isInput:function(t){return!(!t||!t.nodeType||1!=t.nodeType||"input"!=t.nodeName.toLowerCase())},setInput:function(t,e){t.bindId||(t.bindId=++this.maxId);var i=t.bindId;this.datas[i]||(this.datas[i]={el:t});for(var s in e)this.datas[i][s]=e[s];t.type="text"},initFormat:function(t){var e=this.format||{str:"YYYY-MM-DD"};if("string"!=typeof t)return e;if(/\d/.test(t))return e;var i={str:t};return/YYYY(?!Y)/.test(t)&&(i.Y=!0),/MM(?!M)/.test(t)&&(i.M=!0),/DD(?!D)/.test(t)&&(i.D=!0),/hh(?!h)/.test(t)&&(i.h=!0),/mm(?!m)/.test(t)&&(i.m=!0),/ss(?!s)/.test(t)&&(i.s=!0),i},showPicker:function(e){if(e&&e.bindId){e.blur(),this.check[e.bindId]||(this.check[e.bindId]={}),this.endSelect(),this.state.focus=this.datas[e.bindId],this.state.date=this.getDate(),this.judgeRange();var i=this.initPicker();r(this.doms.box,"block"),t.scrollTo(0,i)}},endSelect:function(){},initPicker:function(){var e=this.state,i=e.date,s=e.focus,a=s.format||this.format,n=this.doms,h=n.box,d=n.point;if(a.D||a.h||a.m||a.s)if(o(h,"-date-picker"),this.setCurrent(i.Y,i.M),a.h||a.m||a.s)r([n.hour,n.minute,n.second,n.confirm],"inline-block"),r([n.today,n.yesterday,n.lastweek,n.lastmonth],"none"),n.hourBtn.innerText=i.hs,n.minuteBtn.innerText=i.ms,n.secondBtn.innerText=i.ss,this.type=4;else{r([n.hour,n.minute,n.second,n.confirm],"none"),r([n.today,n.yesterday,n.lastweek,n.lastmonth],"inline-block");var c=i.d-this.minDate.d;o([n.today,n.yesterday,n.lastweek,n.lastmonth],"un"),c>0&&(o(n.today,""),(c-=36e5*i.h+6e4*i.m+1e3*i.s+i.d.getMilliseconds())>0&&(o(n.yesterday,""),s.range&&(c-864e5*i.w>0&&o(n.lastweek,""),c-864e5*i.D>0&&o(n.lastmonth,"")))),this.type=3}else a.M?(this.showMonthBox(),this.type=2):(this.showYearBox(),this.type=1);var l=s.offset.top,m=s.offset.height,u=s.offset.left;s.offset.width;h.style.top=l+m+"px",u+e.boxWidth>t.innerWidth?(h.style.left=t.innerWidth-e.boxWidth+"px",d.style.left=u-t.innerWidth+e.boxWidth+15+"px"):(h.style.left=u+"px",d.style.left="10%");return l-(t.innerHeight-e.boxHeight-m)},getDate:function(t){var e=t?new Date(t):new Date,i={d:e,Y:e.getFullYear(),M:e.getMonth()+1,D:e.getDate(),w:e.getDay()||7,h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};return i.Ms=this.toFiexd(i.M),i.Ds=this.toFiexd(i.D),i.hs=this.toFiexd(i.h),i.ms=this.toFiexd(i.m),i.ss=this.toFiexd(i.s),i},toFiexd:function(t){return t>9?t:"0"+t},judgeRange:function(){var t=this.state.focus;t.min?"string"==typeof t.min?this.minDate=this.judgeDateStr(t.min):this.minDate=t.min:this.minDate=this.judgeDateStr("Y5"),t.max?"string"==typeof t.max?this.maxDate=this.judgeDateStr(t.max,1):this.maxDate=t.max:this.maxDate=this.judgeDateStr("Y5",1)},judgeDateStr:function(t,e){if("now"==t)return this.getDate();var i=t.match(/[YMD]\d+(?!\d)/g);if(i){for(var s={},a=0;a<i.length;a++)s[i[a].match(/[YMD]/)[0]]=~~i[a].match(/\d+/)[0];if(!e)for(var n in s)s[n]=-s[n];return this.judgeDate(s)}return!!(s=this.initDate(t,e))&&this.getDate(s.str)},judgeDate:function(t,e){return e=e||this.getDate(),t.D&&e.d.setDate(e.D+t.D),t.M&&e.d.setMonth(e.M+t.M-1),t.Y&&e.d.setFullYear(e.Y+t.Y),this.getDate(e.d.getTime())},judgeDay:function(t,e){return 13==e&&(t++,e=1),0==e&&(t--,e=12),2!=e?this.day[e-1]:t%4?this.day[1][0]:this.day[1][1]},initDate:function(t,e){for(var i=(e=e||this.format).str.replace(/YYYY(?!Y)/,0).replace(/MM(?!M)/,1).replace(/DD(?!D)/,2).replace(/hh(?!h)/,3).replace(/mm(?!m)/,4).replace(/ss(?!s)/,5).replace(/\D/g," ").split(" "),s=t.replace(/\D/g," ").split(" "),a=[],n=0;n<s.length;n++)i[n]&&(a[i[n]]=s[n]);return void 0!=a[0]&&void 0!=a[1]&&void 0!=a[2]&&(t=a[0]+"/"+a[1]+"/"+a[2],void 0!=a[3]&&(t+=" ",t+=a[3],a[4]||(a[4]="00"),t+=":",t+=a[4],a[5]||(a[5]="00"),t+=":",t+=a[5]),{arr:a,str:t})},mosaicDateStr:function(t,e){return(e=e||this.format).str.replace(/YYYY(?!Y)/,t.Y).replace(/MM(?!M)/,this.toFiexd(t.M)).replace(/DD(?!D)/,this.toFiexd(t.D)).replace(/hh(?!h)/,this.toFiexd(t.h)).replace(/mm(?!m)/,this.toFiexd(t.m)).replace(/ss(?!s)/,this.toFiexd(t.s))},sortDate:function(t,e,i){i=i||this.format;var s,a;return new Date(this.initDate(t,i).str)>new Date(this.initDate(e,i).str)?(s=t,a=e):(s=e,a=t),{max:s,min:a}},setBtnMsg:function(t,e){this.doms.btn.innerHTML=t+"年"+this.toFiexd(e)+"月"},setCurrent:function(t,e){this.state.step[1]||this.createDayBox(),this.state.Y=t,this.state.M=e,this.setBtnMsg(t,e),this.showMonth(t,e),this.doms.year.setAttribute("data-month",e-1),this.showMonth(t,e+1),this.showMonth(t,e-1)},showMonth:function(t,e){if(e<1||e>12)return!1;var i,n,r,o=this.doms.months,h=this.state,c=h.focus.el,l=c.bindId,m=c.bindElId,u=this.check[l],v=this.check[m];o[e-1].innerHTML=this.mosaicMonth(t,e),i=d(o[e-1],"-date-picker-date"),t==h.Y&&e==h.M&&(h.btns=i);for(var f=0;f<42;f++)n=~~i[f].innerText,r=a(i[f],"un"),u&&u.D&&(u&&t==u.Y&&e!=u.M?u.D==n&&r&&s(i[f],"active"):u.D!=n||r||s(i[f],"active")),v&&v.D&&(t==v.Y&&e!=v.M?v.D==n&&r&&s(i[f],"active"):v.D!=n||r||s(i[f],"active"),t==v.Y&&v.M)},mosaicMonth:function(t,e){if(this.cache[t]||(this.cache[t]={}),!this.cache[t][e]){var i="<div class='-bg-month'>"+e+"</div>",s=this.getDate(t+"/"+e).w,a=this.judgeDay(t,e),n=this.judgeDay(t,e-1);return i+=this.mosaicDay(s,n-s),i+=this.mosaicDay(a),s+=a,i+=this.mosaicDay(42-s),this.cache[t][e]=i,i}return this.cache[t][e]},mosaicDay:function(t,e){this.getDate();var i="";e=e||0;for(var s=0;s<t;s++)i+="<button class='-date-picker-date",(t<28||e>0)&&(i+=" un' data-skip='",i+=e>0?"prev":"next"),i+="'>",s+e<9&&(i+="&ensp;"),i+=s+e+1,i+="</button>";return i},prevMonth:function(){var t=this.state.Y,e=this.state.M;1==e?(t--,e=13,this.setDayBoxCss()):this.setDayBoxCss(0),this.setCurrent(t,e-1)},nextMonth:function(){var t=this.state.Y,e=this.state.M;12==e?(t++,e=0,this.setDayBoxCss()):this.setDayBoxCss(0),this.setCurrent(t,e+1)},setDayBoxCss:function(t){var e=this.doms.year;"number"==typeof t?0==t?e.style.cssText="transition:transform 300ms;":(t=-t,e.style.cssText="-webkit-transform: translateY("+t+"px) translateZ(0);-moz-transform: translateY("+t+"px) translateZ(0);-ms-transform: translateY("+t+"px) translateZ(0);-o-transform: translateY("+t+"px) translateZ(0);transform: translateY("+t+"px) translateZ(0);"):e.style.cssText=""},showMonthBox:function(){this.state.step[3]||this.createMonthBox();for(var t=this.doms,e=this.minDate,i=this.maxDate,s=e.Y-4,a=i.Y+4,n=this.state.cY||this.state.Y||this.getDate().Y,r="",h=s;h<=a;h++)r+="<button class='-d-p-s-y'",(h<e.Y||h>i.Y)&&(r+=" style='color:#999'"),r+=">",r+=h,r+="</button>";t.touchBox.innerHTML=r,this.setMonthBox(n),this.state.cY=n,o(t.box,"-date-picker -month")},setMonthBox:function(t){t=t||0;var e=this.minDate,i=this.maxDate;t=t<e.Y?e.Y:t>i.Y?i.Y:t;var s=this.doms,a=t-e.Y+4,n=s.touchBox;if(s.yearDrag.setAttribute("data-jump",a),a*=-1,n.style.cssText="                transition:left 300ms;                -webkit-transform: translateZ(0);                -moz-transform: translateZ(0);                -ms-transform: translateZ(0);                -o-transform: translateZ(0);                transform: translateZ(0);                left: "+a+"00%;",s.yearDrag.setAttribute("data-year",t),this.state.cY=t,t!=e.Y)if(t!=i.Y)o(s.monthBtns,"-d-p-s-month");else for(r=0;r<12;r++)r+1>i.M?o(s.monthBtns[r],"-d-p-s-month un"):o(s.monthBtns[r],"-d-p-s-month");else for(var r=0;r<12;r++)r+1<e.M?o(s.monthBtns[r],"-d-p-s-month un"):o(s.monthBtns[r],"-d-p-s-month")},showYearBox:function(){this.state.step[4]||this.createYearBox();var t,e,i=this.minDate,s=this.maxDate,a=i.Y-4,n=s.Y+4,r=this.state.cY||this.state.Y||this.getDate().Y,h=this.doms,d=h.yearRnage,c=h.yearBox,l="";d.innerText=i.Y+" - "+s.Y,n+=(t=n-a)<12?12-t:3-(t=(t%=3)||3);for(var m=a;m<n;m++)l+="<button class='-d-p-s-year",m<i.Y||m>s.Y?l+=" un":m==r&&(l+=" in"),l+="' data-year='",l+=m,l+="'>",l+=m,l+="</button>";c.innerHTML=l,e=~~((r-a)/3)-1,this.setYearBox(e,1),this.state.cY=r,o(h.box,"-date-picker -year")},setYearBox:function(t,e){var i,s="";e&&(s+="transition:transform 300ms;",i=this.doms.yearBox.childNodes.length/3-4,t=t<0?0:t>i?i:t),this.doms.yearBox.setAttribute("data-row",t),s+="                -webkit-transform:translateY("+(t*=-25)+"%) translateZ(0);                -moz-transform:translateY("+t+"%) translateZ(0);                -ms-transform:translateY("+t+"%) translateZ(0);                -o-transform:translateY("+t+"%) translateZ(0);                transform:translateY("+t+"%) translateZ(0);",this.doms.yearBox.style.cssText=s},touchS:function(e,i){i=i||t.event;var s=event.touches[0],a=this.doms;switch(e){case a.dayBox:this.touch={sy:s.clientY,my:s.clientY,bh:a.dayBox.offsetHeight};break;case a.yearDrag:this.touch={Y:~~a.yearDrag.getAttribute("data-year"),j:~~a.yearDrag.getAttribute("data-jump"),sx:s.clientX,mx:s.clientX,bw:a.touchBox.offsetWidth};break;case a.yearBox:this.touch={sy:s.clientY,my:s.clientY,ro:~~a.yearBox.getAttribute("data-row"),bh:a.yearBox.offsetHeight/4}}return!1},touchM:function(e,i){i=i||t.event;var s=this.doms;switch(e){case s.dayBox:var a=this.state.M-1,n=i.touches[0].clientY;this.touch.my=n,this.setDayBoxCss(a*this.touch.bh+this.touch.sy-n);break;case s.yearDrag:var r=i.touches[0].clientX;(o=this.touch).mx=r,s.touchBox.style.cssText="left:"+-100*((o.sx-r)/o.bw+o.j)+"%;";break;case s.yearBox:n=i.touches[0].clientY;var o=this.touch;this.touch.my=n,this.setYearBox((o.sy-n)/o.bh+o.ro)}return!1},touchE:function(e,i){i=i||t.event;var s=this.touch,a=this.doms;switch(e){case a.dayBox:if(s.my===s.sy)return!1;var n=s.my-s.sy;Math.abs(n)>=s.bh/4?n>0?this.prevMonth():n<0&&this.nextMonth():this.setDayBoxCss(0);break;case a.yearDrag:if(s.mx===s.sx)return!1;var r=s.Y+(s.sx-s.mx)/s.bw;r%1>=.5&&r++,this.setMonthBox(~~r);break;case a.yearBox:if(s.my===s.sy)return!1;var o=(s.sy-s.my)/s.bh+s.ro;o%1>=.5&&o++,this.setYearBox(~~o,1)}return!1},mouseW:function(e,i){if(this.state.wheel)return!1;this.state.wheel=!0,i=i||t.event,this.disabledEvent(i);var s=this.doms;if(this.isFF)if(i.detail>0)switch(e){case s.dayBox:this.nextMonth();break;case s.yearDrag:this.setMonthBox(1+~~e.getAttribute("data-year"));break;case s.yearBox:this.setYearBox(1+~~e.getAttribute("data-row"),1)}else switch(e){case s.dayBox:this.prevMonth();break;case s.yearDrag:this.setMonthBox(e.getAttribute("data-year")-1);break;case s.yearBox:this.setYearBox(e.getAttribute("data-row")-1,1)}else if(i.wheelDelta>0)switch(e){case s.dayBox:this.prevMonth();break;case s.yearDrag:this.setMonthBox(e.getAttribute("data-year")-1);break;case s.yearBox:this.setYearBox(e.getAttribute("data-row")-1,1)}else switch(e){case s.dayBox:this.nextMonth();break;case s.yearDrag:this.setMonthBox(1+~~e.getAttribute("data-year"));break;case s.yearBox:this.setYearBox(1+~~e.getAttribute("data-row"),1)}return this.state.wheel=!1,!1},clickEv:function(i,n){n=n||t.event,this.disabledEvent(n);var r=this.doms;switch(i){case r.btnBox:this.showMonthBox();break;case r.yearDrag:this.showYearBox();break;case r.today:case r.yesterday:case r.lastweek:case r.lastmonth:case r.hour:case r.minute:case r.second:case r.confirm:this.hidePicker();break;case r.dayBox:if(!(Y=c(n.target,".-date-picker-date")))return!1;var o=Y.innerText;if(a(Y,"un")){var h=Y.getAttribute("data-skip");if(h){var l=this.state.M;if(this[h+"Month"](),l!=this.state.M){l=this.state.M-1;for(var m,u=d(this.doms.months[l],"-date-picker-date"),v=0;v<42;v++)if(!a(u[v],"un")&&u[v].innerText==o){m=u[v];break}m&&function(t,i){if(e.createEventObject){var s=e.createEventObject();return t.fireEvent("on"+i,s)}(s=e.createEvent("HTMLEvents")).initEvent(i,!0,!0),t.dispatchEvent(s)}(m,"click")}}}else{var f=this.state,p=~~o,b=f.focus,y=b.el.bindId,x=this.check[y];if(x.Y=f.Y,x.M=f.M,x.D=p,s(Y,"active"),3==this.type){var k,g=this.mosaicDateStr({Y:x.Y,M:x.M,D:p},b.format);b.el.value=g,b.range||(g,k={value:g},this.hidePicker()),this.api.value=g,this.callback(k)}}break;case r.prevYear:this.setYearBox(r.yearBox.getAttribute("data-row")-1,1);break;case r.nextYear:this.setYearBox(1+~~r.yearBox.getAttribute("data-row"),1);break;case r.monthBox:if(!(Y=c(n.target,".-d-p-s-month"))||"-d-p-s-month un"==Y.className)return!1;l=~~Y.getAttribute("data-month");var D=this.state.focus;this.type>2?this.setCurrent(this.state.cY,l):D.el.value=this.mosaicDateStr({Y:this.state.cY,M:l},D.format),this.back();break;case r.yearBox:var Y;if(!(Y=c(n.target,".-d-p-s-year"))||"-d-p-s-year un"==Y.className)return!1;var M=~~Y.getAttribute("data-year");D=this.state.focus;this.type>1?this.setMonthBox(M):D.el.value=this.mosaicDateStr({Y:M},D.format),this.back()}return!1},back:function(){var t=this.doms.box,e=t.className,i=this.type;switch(e){case"-date-picker -month":i>2?(o(t,"-date-picker"),this.state.cY=0):this.hidePicker();break;case"-date-picker -year":i>1?o(t,"-date-picker -month"):this.hidePicker();break;case"-date-picker":this.hidePicker()}},callback:function(t){this.api.callback instanceof Function&&this.api.callback(t)}},t.DatePicker=m);function s(t,e){if(!t.className)return t.className=e;a(t,e)||(t.className+=" "+e)}function a(t,e){if(!t.className)return!1;return!!new RegExp("(^|\\s+)"+e+"(\\s+|$)").test(t.className)}function n(t){return e.createElement(t)}function r(t,e){if(1==t.nodeType)t.style.display=e;else for(var i=0;i<t.length;i++)t[i].style.display=e}function o(t,e){if(1==t.nodeType)t.className=e;else for(var i=0;i<t.length;i++)t[i].className=e}function h(e,i,s,a){a?e.removeEventListener?e.removeEventListener(i,s):e.detachEvent?(e.detachEvent("on"+i,e[i+s]),e[i+s]=null,e["e"+i+s]=null):e["on"+i]=null:e.addEventListener?e.addEventListener(i,s):e.attachEvent?(e["e"+i+s]=s,e[i+s]=function(){e["e"+i+s](t.event)},e.attachEvent("on"+i,e[i+s])):e["on"+i]=s}function d(t,e){if(t.getElementsByClassName)return t.getElementsByClassName(e);for(var i=[],s=new RegExp("(^|\\s+)"+e+"(\\s+|$)"),a=t.getElementsByTagName("*"),n=0;n<a.length;n++)s.test(a[n].className)&&i.push(a[n]);return i}function c(t,e){if(e.nodeType&&1==e.nodeType)for(;t&&t!=e;)t=t.parentElement;else{var i=e.split("");if("."==i[0]){e=e.replace(".","");for(var s=new RegExp("(^|\\s+)"+e+"(\\s+|$)");t&&(!t.className||!s.test(t.className));)t=t.parentElement}else if("#"==i[0])for(e=e.replace("#","");t&&t.id!=e;)t=t.parentElement;else for(;t&&t.nodeName.toLowerCase()!=e;)t=t.parentElement}return t}function l(t){var e={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight};for(t=t.offsetParent;null!=t;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;return e}function m(t){return console.time("初始化时间选择器"),this.monthEn=["Jan","Fed","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.month=["一","二","三","四","五","六","七","八","九","十","十一","十二"],this.week=["日","一","二","三","四","五","六"],this.day=[31,[28,29],31,30,31,30,31,31,30,31,30,31],this.type=3,this.isFF=/.*Firefox.*/.test(navigator.userAgent),this.doms={},this.datas={},this.state={},this.cache={},this.touch={},this.check={},this.maxId=(new Date).getTime(),this.init(t),console.timeEnd("初始化时间选择器"),this.api}}(window,document);