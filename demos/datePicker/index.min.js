!function(t,e){"use strict";function i(t,e,i,s){s?t.removeEventListener?t.removeEventListener(e,i):t.detachEvent?(t.detachEvent("on"+e,t[e+i]),t[e+i]=null,t["e"+e+i]=null):t["on"+e]=null:t.addEventListener?t.addEventListener(e,i):t.attachEvent?(t["e"+e+i]=i,t[e+i]=function(){t["e"+e+i](window.event)},t.attachEvent("on"+e,t[e+i])):t["on"+e]=i}function s(t,e){if(t.getElementsByClassName)return t.getElementsByClassName(e);for(var i=[],s=t.getElementsByTagName("*"),a=0;a<s.length;a++)for(var n=s[a].className.split(" "),r=0;r<n.length;r++)if(n[r]===e){i.push(s[a]);break}return i}function a(t,e){if(!t.className)return t.className=e;for(var i=t.className.split(" "),s=!1,a=0;a<i.length;a++)i[a]===e&&(s=!0);s||(t.className+=" "+e)}function n(t,e){if(!t.className||t.className==e)return t.className="";for(var i=t.className.split(" "),s=0;s<i.length;s++)i[s]===e&&(i.splice(s,1),t.className=i.join(" "))}function r(t,e){if(!t.className)return!1;for(var i=!1,s=t.className.split(" "),a=0;a<s.length;a++)s[a]===e&&(i=!0);return i}function h(t,e){for(var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t&&!i.call(t,e);)t=t.parentElement;return t}function o(t,e){if(document.createEventObject){var i=document.createEventObject();return t.fireEvent("on"+e,i)}return(i=document.createEvent("HTMLEvents")).initEvent(e,!0,!0),!t.dispatchEvent(i)}function c(t){var e={top:t.offsetTop,left:t.offsetLeft,width:t.offsetWdith,height:t.offsetHeight};for(t=t.offsetParent;null!=t;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;return e}function d(t){for(var e=t.parentNode.children,i=0;i<e.length;i++)if(e[i]===t)return i}function l(){this.join="-",this.wW=t.innerWidth,this.wH=t.innerHeight,this.touchState={},this.inputs=Array.prototype.slice.call(s(document,"datepicker"),0),this.maxID=(new Date).getTime(),this.scrollEl=t,this.btnArr={},this._init()}t.DatePicker||(l.prototype={set:function(t,e){var s=e instanceof Object;if(t instanceof HTMLElement)if("input"==t.nodeName.toLowerCase()){for(var a=!1,n=0;n<this.inputs.length;n++)if(this.inputs[n]===t){a=!0;break}a||(i(t,"focus",this._inputFocus.bind(this,t)),this.inputs.push(t),t.type="text",s&&(t.datePickerData={range:e.range||null,min:e.min||null,max:e.max||null,bind:e.bind||null}))}else console.dir(t);else try{for(var r=t.length,n=0;n<r;n++){var h=t[n];if(h instanceof HTMLElement)if("input"==h.nodeName.toLowerCase()){for(var a=!1,o=0;o<this.inputs.length;o++)if(this.inputs[o]===h){a=!0;break}a||(i(h,"focus",this._inputFocus.bind(this,h)),this.inputs.push(h),h.type="text",s&&(h.datePickerData={range:e.range||null,min:e.min||null,max:e.max||null,bind:e.bind||null}))}else console.dir(h);else console.dir(h)}}catch(t){console.log("传入的元素或许不是输入框")}},prev:function(){var t=this.currentMonth-1;if(t<0){var e=this.currentYear-1;if(e<this.min.year)return!0;this.currentYear=e,this.yearBox.style.cssText="",this.yearBox.innerHTML="",this.currentMonth=11,this.yearBox.setAttribute("data-month",11),this._mosaicObj(this.currentYear)}else{if(this.currentYear<=this.min.year&&t<this.min.month)return!0;this.currentMonth=t,this.yearBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;",this.yearBox.setAttribute("data-month",this.currentMonth)}return this.ymBtn.innerHTML=this.currentYear+"年"+(this.currentMonth<9?"0"+(this.currentMonth+1):this.currentMonth+1)+"月",!0},next:function(){var t=this.currentMonth+1;if(t>11){var e=this.currentYear+1;if(e>this.max.year)return!0;this.currentYear=e,this.yearBox.style.cssText="",this.yearBox.innerHTML="",this.currentMonth=0,this.yearBox.setAttribute("data-month",0),this._mosaicObj(this.currentYear)}else{if(this.currentYear>=this.max.year&&t>this.max.month)return!0;this.currentMonth=t,this.yearBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;",this.yearBox.setAttribute("data-month",this.currentMonth)}return this.ymBtn.innerHTML=this.currentYear+"年"+(this.currentMonth<9?"0"+(this.currentMonth+1):this.currentMonth+1)+"月",!0},_prev:function(t){if(0==this.yearRangePosition){if(!t)return!1;this.yearBtnBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;-webkit-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-moz-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-ms-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-o-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);"}var t=t||1,e=this.yearRangePosition-t;e=e<0?0:e,this.yearRangePosition=e,e*=25,this.yearBtnBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;-webkit-transform: translateY(-"+e+"%) translateZ(0);-moz-transform: translateY(-"+e+"%) translateZ(0);-ms-transform: translateY(-"+e+"%) translateZ(0);-o-transform: translateY(-"+e+"%) translateZ(0);transform: translateY(-"+e+"%) translateZ(0);"},_next:function(t){var e=this.yearBtns.length/3-4;if(this.yearRangePosition==e){if(!t)return!1;this.yearBtnBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;-webkit-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-moz-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-ms-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);-o-transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);transform: translateY(-"+this.yearRangePosition+"%) translateZ(0);"}var t=t||1,i=this.yearRangePosition+t;i=i>e?e:i,this.yearRangePosition=i,i*=25,this.yearBtnBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;-webkit-transform: translateY(-"+i+"%) translateZ(0);-moz-transform: translateY(-"+i+"%) translateZ(0);-ms-transform: translateY(-"+i+"%) translateZ(0);-o-transform: translateY(-"+i+"%) translateZ(0);transform: translateY(-"+i+"%) translateZ(0);"},_init:function(){this._initInputs();var t=new Date;this.currentYear=t.getFullYear(),this.currentMonth=t.getMonth(),this.day={},this._create()&&(this._getElement()._mosaicObj(this.currentYear),this._initEvent())},_reSize:function(){this.wW=t.innerWidth,this.wH=t.innerHeight,this.datePicker.style.visibility="hidden",this.datePicker.style.display="block",this.datePickerW=this.datePicker.offsetWidth,this.datePickerH=this.datePicker.offsetHeight,this.datePicker.style.display="none",this.datePicker.style.visibility="visible"},_create:function(){var t=document.createElement("style");return t.type="text/css",t.innerHTML="",document.getElementsByTagName("head")[0].appendChild(t),this.datePicker=document.createElement("div"),this.datePicker.className="-date-picker",this.datePicker.innerHTML="<div class='-date-picker-point'><div class='-rotate45'></div></div><div class='-date-picker-main'><div class='-date-picker-foot'><div><div class='-date-picker-ym -d-p-middle'><button id='-date-picker-ym'>"+this.currentYear+"年"+(this.currentMonth<9?"0"+(this.currentMonth+1):this.currentMonth+1)+"月</button><span class='-dpcymt -rotate45'></span></div></div></div><div class='-date-picker-day'><div><div class='-date-picker-title'><span class='-d-p-middle'>日</span><span class='-d-p-middle'>一</span><span class='-d-p-middle'>二</span><span class='-d-p-middle'>三</span><span class='-d-p-middle'>四</span><span class='-d-p-middle'>五</span><span class='-d-p-middle'>六</span></div><div class='-date-picker-prev'><div class='-rotate45'></div></div><div class='-date-picker-box'><div id='-date-picker-year' data-month='"+this.currentMonth+"' style='-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;'></div></div><div class='-date-picker-next'><div class='-rotate45'></div></div></div></div><div class='-date-picker-btn'><div><div><button class='-date-picker-btn-tday'>今&emsp;天</button></div><div><button class='-date-picker-btn-ystday'>昨&emsp;天</button></div><div><button class='-date-picker-btn-lsweek'>上一周</button></div><div><button class='-date-picker-btn-lsmonth'>上一月</button></div></div></div><div class='-date-picker-select'><div class='-d-p-select-head'><div><div class='-d-p-select-year-touch'><div class='-d-p-select-left'></div><div class='-d-p-select-box'><div id='-d-p-select-year'></div></div><div class='-d-p-select-right'></div></div><button class='-d-p-select-year-range'></button></div></div><div class='-d-p-select-year-month'><div><div class='-d-p-s-year-box'><div class='-d-p-s-year-prev '><div class='-rotate45'></div></div><div class='-d-p-s-y-box'><div id='-d-p-s-y-box'></div></div><div class='-d-p-s-year-next'><div class='-rotate45'></div></div></div><div class='-d-p-s-month-box'><div class='-d-p-s-month' date-month='1'><div class='-d-p-middle'>一月<div class='-d-p-s-m-en'>Jan</div></div></div><div class='-d-p-s-month' date-month='2'><div class='-d-p-middle'>二月<div class='-d-p-s-m-en'>Fed</div></div></div><div class='-d-p-s-month' date-month='3'><div class='-d-p-middle'>三月<div class='-d-p-s-m-en'>Mar</div></div></div><div class='-d-p-s-month' date-month='4'><div class='-d-p-middle'>四月<div class='-d-p-s-m-en'>Apr</div></div></div><div class='-d-p-s-month' date-month='5'><div class='-d-p-middle'>五月<div class='-d-p-s-m-en'>May</div></div></div><div class='-d-p-s-month' date-month='6'><div class='-d-p-middle'>六月<div class='-d-p-s-m-en'>Jun</div></div></div><div class='-d-p-s-month' date-month='7'><div class='-d-p-middle'>七月<div class='-d-p-s-m-en'>Jul</div></div></div><div class='-d-p-s-month' date-month='8'><div class='-d-p-middle'>八月<div class='-d-p-s-m-en'>Aug</div></div></div><div class='-d-p-s-month' date-month='9'><div class='-d-p-middle'>九月<div class='-d-p-s-m-en'>Sep</div></div></div><div class='-d-p-s-month' date-month='10'><div class='-d-p-middle'>十月<div class='-d-p-s-m-en'>Oct</div></div></div><div class='-d-p-s-month' date-month='11'><div class='-d-p-middle'>十一月<div class='-d-p-s-m-en'>Nov</div></div></div><div class='-d-p-s-month' date-month='12'><div class='-d-p-middle'>十二月<div class='-d-p-s-m-en'>Dec</div></div></div></div></div></div></div></div>",document.body.appendChild(this.datePicker),this.datePickerW=this.datePicker.offsetWidth,this.datePickerH=this.datePicker.offsetHeight,this.datePicker.style.display="none",!0},_getElement:function(){return this.point=s(this.datePicker,"-date-picker-point")[0],this.yearMonth=s(this.datePicker,"-date-picker-ym")[0],this.ymBtn=document.getElementById("-date-picker-ym"),this.box=s(this.datePicker,"-date-picker-box")[0],this.yearBox=document.getElementById("-date-picker-year"),this.prevEl=s(this.datePicker,"-date-picker-prev")[0],this.nextEl=s(this.datePicker,"-date-picker-next")[0],this.today=s(this.datePicker,"-date-picker-btn-tday")[0],this.yesterday=s(this.datePicker,"-date-picker-btn-ystday")[0],this.lastWeek=s(this.datePicker,"-date-picker-btn-lsweek")[0],this.lastMonth=s(this.datePicker,"-date-picker-btn-lsmonth")[0],this.yearTouch=s(this.datePicker,"-d-p-select-year-touch")[0],this.yearTouchInner=document.getElementById("-d-p-select-year"),this.yearRange=s(this.datePicker,"-d-p-select-year-range")[0],this.yearPrev=s(this.datePicker,"-d-p-s-year-prev")[0],this.yearNext=s(this.datePicker,"-d-p-s-year-next")[0],this.yearBtnBox=document.getElementById("-d-p-s-y-box"),this.monthBtnBox=s(this.datePicker,"-d-p-s-month-box")[0],this.monthBtns=s(this.datePicker,"-d-p-s-month"),this},_initPicker:function(t){n(this.datePicker,"-year"),n(this.datePicker,"-show");var e=new Date,i=e.getFullYear(),s=e.getMonth(),r=!1;this.dateCache||(i!=this.currentYear&&(this.currentYear=i,r=!0),s!=this.currentMonth&&(this.currentMonth=s,this.yearBox.setAttribute("data-month",s),r=!0),r&&(this.ymBtn.innerHTML=this.currentYear+"年"+(this.currentMonth<9?"0"+(this.currentMonth+1):this.currentMonth+1)+"月"),t.datePickerData.range?(n(this.lastWeek,"un"),n(this.lastMonth,"un")):(a(this.lastWeek,"un"),a(this.lastMonth,"un")),this._mosaicObj(i));var h=c(t),o=h.top,d=h.height,l=h.left;h.width;return this.datePicker.style.top=o+d+"px",l+this.datePickerW>this.wW?(this.datePicker.style.left=this.wW-this.datePickerW+"px",this.point.style.left=l-this.wW+this.datePickerW+15+"px"):(this.datePicker.style.left=l+"px",this.point.style.left="10%"),h},_inputFocus:function(e){if(e.blur(),this._inputBlur(e),this.input=e,!this.dateCache){var i=new Date,s=e.datePickerData.min||"2008.01.01",a=e.datePickerData.max;a?"now"==a&&(a=i.getFullYear()+"."+(i.getMonth()+1)+"."+i.getDate()):a=i.getFullYear()+2+".12.31","now"==s&&(s=i.getFullYear()+"."+(i.getMonth()+1)+"."+i.getDate()),s=s.replace(/\D/g,".").replace(".","/").replace(".","/").replace("."," ").replace(".",":").replace(".",":"),a=a.replace(/\D/g,".").replace(".","/").replace(".","/").replace("."," ").replace(".",":").replace(".",":"),i=new Date(s),this.min={year:i.getFullYear(),month:i.getMonth(),day:i.getDate(),hours:i.getHours(),minute:i.getMinutes(),second:i.getSeconds()},i=new Date(a),this.max={year:i.getFullYear(),month:i.getMonth(),day:i.getDate(),hours:i.getHours(),minute:i.getMinutes(),second:i.getSeconds()}}var n=this._initPicker(e);this.datePicker.style.display="block";var r,h=n.top,o=n.height,c=this.wH-this.datePickerH-o;return this.scrollEl===t?(r=h-c,t.scrollTo(0,r)):(r=this.wH-this.datePickerH+this.scrollEl.scrollTop,this.scrollEl.scrollTop=r),!1},_inputBlur:function(t){if(this.dateCache)if(this.dateCache.start&&this.dateCache.end){if(this.dateCache.start!=t&&this.dateCache.end!=t){var i;if("start"==this.dateCache.on){var s=this.dateCache.end.datePickerData.max;if("now"!=s&&s)i=s.replace(".",this.join).replace(".",this.join).replace("."," ").replace(".",":").replace(".",":");else{var a=new Date;i=this._mosaicStr(a.getFullYear(),a.getMonth(),a.getDate())}this.dateCache.end.value=i}else{var r=this.dateCache.end.datePickerData.min;i=r?r.replace(".",this.join).replace(".",this.join).replace("."," ").replace(".",":").replace(".",":"):this._mosaicStr(2008,0,1),this.dateCache.start.value=i}this.dateCache=e,n(this.active.btn,"active"),this.active=e,this.btnArr={}}}else t!=this.input&&(this.dateCache=e,n(this.active.btn,"active"),this.active=e,this.btnArr={})},_disableEvent:function(e){return(e=e||t.event).preventDefault(),e.stopPropagation(),!1},_defaultTouch:function(e){var i=h((e=e||t.event).target,".-date-picker"),s=h(e.target,"input"),a=!0;if(s)for(var n=0;n<this.inputs.length;n++)if(this.inputs[n]===s){a=!1;break}!i&&a&&(this.datePicker.style.display="none",this._inputBlur())},_TouchS:function(i){var s=s||t.event;return this.touchState.startX=this.touchState.moveX=s.touches[0].clientX,this.touchState.startY=this.touchState.moveY=s.touches[0].clientY,i===this.box?this.boxH=this.box.offsetHeight:i===this.yearTouch?this.touchState.touchPosition=e:i===this.yearBtnBox?this.touchState.touchPosition=e:void 0},_TouchM:function(e){var i=i||t.event,s=i.touches[0].clientX,a=i.touches[0].clientY;if(this.touchState.moveX=s,this.touchState.moveY=a,e===this.box){r=this.currentMonth*this.boxH+this.touchState.startY-a;this.yearBox.style.cssText="-webkit-transform: translateY("+-r+"px) translateZ(0);-moz-transform: translateY("+-r+"px) translateZ(0);-ms-transform: translateY("+-r+"px) translateZ(0);-o-transform: translateY("+-r+"px) translateZ(0);transform: translateY("+-r+"px) translateZ(0);"}else if(e===this.yearTouch){var n=this.yearTouchPosition+(this.touchState.startX-s)/this.yearTouchInner.offsetWidth;this.touchState.touchPosition=n,n*=100,this.yearTouchInner.style.cssText="-webkit-transform: translateZ(0);-moz-transform: translateZ(0);-ms-transform: translateZ(0);-o-transform: translateZ(0);transform: translateZ(0);left: -"+n+"%;"}else{var r=this.yearRangePosition+(this.touchState.startY-a)/this.yearBtnBox.offsetHeight*4;this.touchState.touchPosition=r,r*=25,this.yearBtnBox.style.cssText="-webkit-transform: translateY("+-r+"%) translateZ(0);-moz-transform: translateY("+-r+"%) translateZ(0);-ms-transform: translateY("+-r+"%) translateZ(0);-o-transform: translateY("+-r+"%) translateZ(0);transform: translateY("+-r+"%) translateZ(0);"}},_TouchE:function(t){if(t===this.box){var e=this.touchState.moveY-this.touchState.startY,i=Math.abs(e)>=this.boxH/4;e>0?(this.yearBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;",i&&this.prev()):e<0&&(this.yearBox.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;",i&&this.next())}else if(t===this.yearTouch)(s=this.touchState.touchPosition)&&(s=s%1<.5?~~s:1+~~s,this._setYTP(s));else{var s=this.touchState.touchPosition;s&&(s=s%1<.5?~~s:1+~~s),(s-=this.yearRangePosition)<0?this._prev(1+~s):this._next(s)}},_setYTP:function(t){var e=this.max.year-this.min.year+4;if(t=t<4?4:t>e?e:t,this.yearTouchInner.style.cssText="-webkit-transition:300ms;-moz-transition:300ms;-ms-transition:300ms;-o-transition:300ms;transition:300ms;-webkit-transform: translateZ(0);-moz-transform: translateZ(0);-ms-transform: translateZ(0);-o-transform: translateZ(0);transform: translateZ(0);left: -"+t+"00%;",4==t)for(i=0;i<this.min.month;i++)a(this.monthBtns[i],"un");else if(t==e)for(i=this.max.month+1;i<12;i++)a(this.monthBtns[i],"un");else if(4==this.yearTouchPosition||this.yearTouchPosition==e)for(var i=0;i<12;i++)n(this.monthBtns[i],"un");this.yearTouchPosition=t,this.cacheYear=this.min.year+t-4},_click:function(i){var n=n||t.event;if(n.preventDefault(),n.stopPropagation(),i===this.yearMonth){for(var h="",o=this.min.year-4,c=this.max.year+4,d=o;d<=c;d++)h+=d<o+4||d>c-4?"<button class='-d-p-s-y' style='color:#999'>":"<button class='-d-p-s-y'>",h+=d,h+="</button>";this.yearTouchInner.innerHTML=h;var l=this.currentYear-o;this.yearTouchInner.style.left="-"+l+"00%",this.yearTouchPosition=l,a(this.datePicker,"-show")}else if(i===this.prevEl)this.prev();else if(i===this.nextEl)this.next();else if(i===this.today){v=new Date;this.input.value=this._mosaicStr(v.getFullYear(),v.getMonth(),v.getDate());var u=this.input.datePickerData.bind,m=this.input.datePickerData.range;if(u&&"start"==m||"end"==m){for(d=0;d<this.inputs.length;d++)if(this.inputs[d].datePickerData.bind==u&&this.inputs[d].datePickerData.range!=m){P=this.inputs[d];break}P&&(P.value=this.input.value)}this.datePicker.style.display="none",this.dateCache=e}else if(i===this.yesterday){var v=new Date,y=this._testDay(v.getFullYear(),v.getMonth(),v.getDate()-1);this.input.value=this._mosaicStr(y.year,y.month,y.day);var u=this.input.datePickerData.bind,m=this.input.datePickerData.range;if(u&&"start"==m||"end"==m){for(d=0;d<this.inputs.length;d++)if(this.inputs[d].datePickerData.bind==u&&this.inputs[d].datePickerData.range!=m){P=this.inputs[d];break}P&&(P.value=this.input.value)}this.datePicker.style.display="none",this.dateCache=e}else if(i===this.lastWeek){if(r(i,"un"))return!1;var p=(v=new Date).getDay()||7,f=v.getFullYear(),k=v.getMonth(),b=v.getDate()-p;b<0?(x={year:(y=this._testDay(f,k,b)).year,month:y.month,day:y.day-6},g={year:y.year,month:y.month,day:y.day}):(g={year:f,month:k,day:b},x={year:(y=this._testDay(v.getFullYear(),v.getMonth(),b-6)).year,month:y.month,day:y.day});var u=this.input.datePickerData.bind,m=this.input.datePickerData.range;if(u&&"start"==m||"end"==m){for(d=0;d<this.inputs.length;d++)if(this.inputs[d].datePickerData.bind==u&&this.inputs[d].datePickerData.range!=m){P=this.inputs[d];break}P?"start"==m?(this.input.value=this._mosaicStr(x.year,x.month,x.day),P.value=this._mosaicStr(g.year,g.month,g.day)):(P.value=this._mosaicStr(x.year,x.month,x.day),this.input.value=this._mosaicStr(g.year,g.month,g.day)):this.input.value=this._mosaicStr(x.year,x.month,x.day)+("/"==this.join?" - ":" / ")+this._mosaicStr(g.year,g.month,g.day)}else this.input.value=this._mosaicStr(x.year,x.month,x.day)+("/"==this.join?" - ":" / ")+this._mosaicStr(g.year,g.month,g.day);this.datePicker.style.display="none",this.dateCache=e}else if(i===this.lastMonth){if(r(i,"un"))return!1;var x,g,v=new Date;x={year:(y=this._testDay(v.getFullYear(),v.getMonth(),0)).year,month:y.month,day:1},g={year:y.year,month:y.month,day:y.day};var u=this.input.datePickerData.bind,m=this.input.datePickerData.range;if(u&&"start"==m||"end"==m){for(var P,d=0;d<this.inputs.length;d++)if(this.inputs[d].datePickerData.bind==u&&this.inputs[d].datePickerData.range!=m){P=this.inputs[d];break}P?"start"==m?(this.input.value=this._mosaicStr(x.year,x.month,x.day),P.value=this._mosaicStr(g.year,g.month,g.day)):(P.value=this._mosaicStr(x.year,x.month,x.day),this.input.value=this._mosaicStr(g.year,g.month,g.day)):this.input.value=this._mosaicStr(x.year,x.month,x.day)+("/"==this.join?" - ":" / ")+this._mosaicStr(g.year,g.month,g.day)}else this.input.value=this._mosaicStr(x.year,x.month,x.day)+("/"==this.join?" - ":" / ")+this._mosaicStr(g.year,g.month,g.day);this.datePicker.style.display="none",this.dateCache=e}else if(i===this.yearTouch){this.yearRange.innerText=this.min.year+"-"+this.max.year;var f=this.cacheYear||this.currentYear,h="",o=this.min.year-4;(l=(c=this.max.year+4)-o)<11?c+=11-l:1==(l=(l+1)%3)?c+=2:2==l&&(c+=1);for(d=o;d<=c;d++)h+="<button class='-d-p-s-year",d<this.min.year||d>this.max.year?h+=" un":d==f&&(h+=" in"),h+="' date-year='",h+=d,h+="'>",h+=d,h+="</button>";var _=(c-o+1)/3-4;l=(l=~~((f-o)/3)-1)>_?_:l,this.yearRangePosition=l,l*=25,this.yearBtnBox.style.cssText="-webkit-transform: translateY(-"+l+"%) translateZ(0);-moz-transform: translateY(-"+l+"%) translateZ(0);-ms-transform: translateY(-"+l+"%) translateZ(0);-o-transform: translateY(-"+l+"%) translateZ(0);transform: translateY(-"+l+"%) translateZ(0);",this.yearBtnBox.innerHTML=h,a(this.datePicker,"-year"),this.yearBtns=s(this.yearBtnBox,"-d-p-s-year")}else i===this.yearRange?this._back():i===this.yearPrev?this._prev():i===this.yearNext&&this._next();return!1},__click:function(i){(i=i||t.event).preventDefault(),i.stopPropagation();var s;if(s=h(i.target,".-date-picker-date"))if(r(s,"prev"))this.prev();else if(r(s,"next"))this.next();else{if(r(s,"un"))return!1;var c=this.currentYear,l=this.currentMonth,u=~~s.innerText,m=this.input.datePickerData.bind,v=this.input.datePickerData.range;if(v){this.dateCache||(this.active={year:c,month:l,day:u,btn:s,index:d(s)-2},a(s,"active"));var y=this._mosaicStr(c,l,u);if(m&&"start"==v||"end"==v)if(this.dateCache){var p=this._sortDay(this.dateCache.str,y);this.dateCache.start.value=p.min,this.dateCache.end.value=p.max,this.datePicker.style.display="none",this.dateCache=e}else{this.input.value=y,this.dateCache={str:y};for(var f,k=0;k<this.inputs.length;k++)if(this.inputs[k].datePickerData.bind==m&&this.inputs[k].datePickerData.range!=v){f=this.inputs[k];break}f?("start"==v?(this.dateCache.start=this.input,this.dateCache.end=f):(this.dateCache.end=this.input,this.dateCache.start=f),this.dateCache.on=v,o(f,"focus")):this.datePicker.style.display="none"}else this.dateCache?(y=(p=this._sortDay(this.dateCache.str,y)).min+("/"==this.join?" - ":" / ")+p.max,this.dateCache=e,this.input.value=y,this.datePicker.style.display="none"):(this.dateCache={str:y},this.input.value=y);this.dateCache||(n(this.active.btn,"active"),this.active=e,this.btnArr={})}else this.input.value=this._mosaicStr(c,l,u),this.datePicker.style.display="none"}else if(s=h(i.target,".-d-p-s-year")){if(r(s,"un"))return!1;var b=(c=~~s.innerText)-this.min.year+4;this._setYTP(b),this._back()}else if(s=h(i.target,".-d-p-s-month")){if(r(s,"un"))return!1;var c=this.yearTouchPosition+this.min.year-4,l=~~s.getAttribute("date-month")-1;c!=this.currentYear&&(this._mosaicObj(c),this.currentYear=c),this.currentMonth=l,this.yearBox.setAttribute("data-month",l),this.ymBtn.innerHTML=this.currentYear+"年"+(this.currentMonth<9?"0"+(this.currentMonth+1):this.currentMonth+1)+"月",n(this.datePicker,"-show")}},_sortDay:function(t,e){var i,s;return new Date(t.replace(this.join,"/").replace(this.join,"/"))>new Date(e.replace(this.join,"/").replace(this.join,"/"))?(i=t,s=e):(s=t,i=e),{max:i,min:s}},_testDay:function(t,e,i){return i<1&&(--e<0&&(e=11,t--),i+=0==e||2==e||4==e||6==e||7==e||9==e||11==e?31:3==e||5==e||8==e||10==e?30:t%4==0?29:28),{year:t,month:e,day:i}},_mouseWheel:function(e){if(this.scroll)return!1;this.scroll=!0;var i=i||t.event;i.preventDefault(),i.stopPropagation();var s=i.detail,a=i.wheelDelta;return s?s>0?e==this.box?this.next():e==this.yearBtnBox?this._next():this._setYTP(this.yearTouchPosition+1):e==this.box?this.prev():e==this.yearBtnBox?this._prev():this._setYTP(this.yearTouchPosition-1):a>0?e==this.box?this.prev():e==this.yearBtnBox?this._prev():this._setYTP(this.yearTouchPosition-1):e==this.box?this.next():e==this.yearBtnBox?this._next():this._setYTP(this.yearTouchPosition+1),delete this.scroll,!1},_initInputs:function(){for(var t={},e=[],i=0;i<this.inputs.length;i++)if("input"==this.inputs[i].nodeName.toLowerCase()){this.inputs[i].datePickerData={range:this.inputs[i].getAttribute("range"),max:this.inputs[i].getAttribute("max"),min:this.inputs[i].getAttribute("min"),bind:this.inputs[i].getAttribute("bind")};var s=this.inputs[i].datePickerData.bind;if(s){var a=this.inputs[i].datePickerData.min,n=this.inputs[i].datePickerData.max;t[s]||(t[s]={inputs:[],min:null,max:null}),n&&(t[s].max=n),a&&(t[s].min=a),t[s].inputs.push(this.inputs[i])}}else e.push(i);for(var r in t)for(var h=t[r].inputs,i=0;i<h.length;i++)h[i].datePickerData.min=t[r].min,h[i].datePickerData.max=t[r].max;for(i=0;i<e.length;i++)this.inputs.splice(i,1)},_initEvent:function(){for(var e=0;e<this.inputs.length;e++)i(this.inputs[e],"focus",this._inputFocus.bind(this,this.inputs[e]));i(this.datePicker,"touchmove",this._disableEvent),i(this.yearBox,"click",this.__click.bind(this)),i(this.yearBtnBox,"click",this.__click.bind(this)),i(this.monthBtnBox,"click",this.__click.bind(this)),i(this.yearMonth,"click",this._click.bind(this,this.yearMonth)),i(this.prevEl,"click",this._click.bind(this,this.prevEl)),i(this.nextEl,"click",this._click.bind(this,this.nextEl)),i(this.today,"click",this._click.bind(this,this.today)),i(this.yesterday,"click",this._click.bind(this,this.yesterday)),i(this.lastWeek,"click",this._click.bind(this,this.lastWeek)),i(this.lastMonth,"click",this._click.bind(this,this.lastMonth)),i(this.yearTouch,"click",this._click.bind(this,this.yearTouch)),i(this.yearRange,"click",this._click.bind(this,this.yearRange)),i(this.yearPrev,"click",this._click.bind(this,this.yearPrev)),i(this.yearNext,"click",this._click.bind(this,this.yearNext)),i(document,"touchstart",this._defaultTouch.bind(this)),i(document,"mousedown",this._defaultTouch.bind(this)),i(t,"resize",this._reSize.bind(this)),i(this.box,"touchstart",this._TouchS.bind(this,this.box)),i(this.box,"touchmove",this._TouchM.bind(this,this.box)),i(this.box,"touchend",this._TouchE.bind(this,this.box)),i(this.box,"touchcancel",this._TouchE.bind(this,this.box)),i(this.yearTouch,"touchstart",this._TouchS.bind(this,this.yearTouch)),i(this.yearTouch,"touchmove",this._TouchM.bind(this,this.yearTouch)),i(this.yearTouch,"touchend",this._TouchE.bind(this,this.yearTouch)),i(this.yearTouch,"touchcancel",this._TouchE.bind(this,this.yearTouch)),i(this.yearBtnBox,"touchstart",this._TouchS.bind(this,this.yearBtnBox)),i(this.yearBtnBox,"touchmove",this._TouchM.bind(this,this.yearBtnBox)),i(this.yearBtnBox,"touchend",this._TouchE.bind(this,this.yearBtnBox)),i(this.yearBtnBox,"touchcancel",this._TouchE.bind(this,this.yearBtnBox)),/.*Firefox.*/.test(navigator.userAgent)?(i(this.box,"DOMMouseScroll",this._mouseWheel.bind(this,this.box)),i(this.yearTouch,"DOMMouseScroll",this._mouseWheel.bind(this,this.yearTouch)),i(this.yearBtnBox,"DOMMouseScroll",this._mouseWheel.bind(this,this.yearBtnBox))):(i(this.box,"mousewheel",this._mouseWheel.bind(this,this.box)),i(this.yearTouch,"mousewheel",this._mouseWheel.bind(this,this.yearTouch)),i(this.yearBtnBox,"mousewheel",this._mouseWheel.bind(this,this.yearBtnBox))),i(this.box,"mouseover",this._mouseO.bind(this)),i(t,"blur",function(){})},_mosaicObj:function(t){var e="<div class='-prev-year'>上一年</div>";if(this.day[t])for(i=0;i<12;i++)e+=this.day[t][i];else{this.day[t]=[];for(var i=1;i<=12;i++){var n=this._mosaicMonth(t,i);this.day[t][i-1]=n,e+=n}}if(e+="<div class='-next-year'>下一年</div>",this.yearBox.innerHTML=e,this.active&&t==this.active.year){var r=s(s(this.yearBox,"-date-picker-month")[this.active.month],"-date-picker-date");this.active.btn=r[this.active.index],a(this.active.btn,"active")}},_mosaicMonth:function(t,e){var i=!1;t%4==0&&(i=!0);var s=0,a="<div class='-date-picker-month'><div class='-before'>"+e+"</div><div class='-after'>"+e+"</div>",n=new Date(t+"/"+e+"/1").getDay();n=0==n?7:n,a+=1==e||2==e||4==e||6==e||9==e||11==e?this._mosaicDate(t,e,n,31-n):5==e||7==e||8==e||10==e||12==e?this._mosaicDate(t,e,n,30-n):i?this._mosaicDate(t,e,n,29-n):this._mosaicDate(t,e,n,28-n),s+=n,1==e||3==e||5==e||7==e||8==e||10==e||12==e?(a+=this._mosaicDate(t,e,31),s+=31):4==e||6==e||9==e||11==e?(a+=this._mosaicDate(t,e,30),s+=30):i?(a+=this._mosaicDate(t,e,29),s+=29):(a+=this._mosaicDate(t,e,28),s+=28);var r=42-s;return a+=this._mosaicDate(t,e,r),a+="</div>"},_mosaicDate:function(t,e,i,s){var a=new Date,n=a.getFullYear(),r=a.getMonth()+1,h=a.getDate()-1,o="";s=s||0;for(var c=0;c<i;c++)s>0||i<28?(o+=s>0?"<button class='-date-picker-date un prev'>":"<button class='-date-picker-date un next'>",c+s<9&&(o+="&ensp;"),o+=c+s+1,o+="</button>"):(o+=c==h&&e==r&&t==n?"<button class='-date-picker-date in'>":"<button class='-date-picker-date'>",c<9&&(o+="&ensp;"),o+=c+1,o+="</button>");return o},_mosaicStr:function(t,i,s,a,n,r){var h;return h=t+this.join+(i<9?"0"+(i+1):i+1)+this.join+(s<10?"0"+s:s),a!=e&&(h+=" ",h+=a,h+=":",h+=n?n<10?"0"+n:n:"00",h+=":",h+=r?r<10?"0"+r:r:"00"),h},_back:function(){var t=this.datePicker;r(t,"-year")?n(t,"-year"):n(t,"-show")},_mouseO:function(e){if(!this.active)return!1;if(e=e||t.event,this.btnArr.year!=this.currentYear||this.btnArr.month!=this.currentMonth){var i=s(this.yearBox,"-date-picker-month")[this.currentMonth];this.btnArr={year:this.currentYear,month:this.currentMonth,btns:s(i,"-date-picker-date")}}var r,o=this.btnArr.btns;if(r=h(e.target,".-date-picker-date")){var c=d(r)-2;if(this.currentYear>this.active.year)for(l=0;l<o.length;l++)l>c?n(o[l],"on"):a(o[l],"on");else if(this.currentYear<this.active.year)for(l=0;l<o.length;l++)l<c?n(o[l],"on"):a(o[l],"on");else if(this.currentMonth>this.active.month)for(l=0;l<o.length;l++)l>c?n(o[l],"on"):a(o[l],"on");else if(this.currentMonth<this.active.month)for(l=0;l<o.length;l++)l<c?n(o[l],"on"):a(o[l],"on");else if(c>this.active.index)for(l=0;l<o.length;l++)l>this.active.index&&l<=c?a(o[l],"on"):n(o[l],"on");else if(c<this.active.index)for(l=0;l<o.length;l++)l>=c&&l<this.active.index?a(o[l],"on"):n(o[l],"on");else for(var l=0;l<o.length;l++)n(o[l],"on")}}},t.DatePicker=l)}(window,void 0);